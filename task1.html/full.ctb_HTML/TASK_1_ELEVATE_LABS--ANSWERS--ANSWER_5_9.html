<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>ANSWER_5</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>ANSWER_5</h1><br/><p>With Wireshark we can analyse plenty of thinks rather than Nmap .</p><p></p><p>First we have to capture the packets or live traffic using tcpdump which is a command line packet capturing tool,  and we have to save the traffic into a pcap file , the traffic here is nothing but Nmap traffic which we are going to create . </p><p></p><p>To capture the traffic run the command :-</p><p></p><p>sudo tcpdump -i eth0 -w nmap_syn_scan.pcap</p><p></p><p>┌─[root@parrot]─[~]</p><p>└──╼ #tcpdump -i enp0s1 -w nmap_syn_scan.pcap</p><p>tcpdump: listening on enp0s1, link-type EN10MB (Ethernet), snapshot length 262144 bytes</p><p>^C12963 packets captured</p><p>12965 packets received by filter</p><p>0 packets dropped by kernel</p><p></p><p></p><p>-i   = network interface </p><p>-w = the file in which we capture the traffic </p><p></p><p>To create the traffic  run the command :- </p><p></p><p>sudo nmap -sS 192.168.1.1/24 </p><p></p><p>Now find the pcap packet and  if you are uncertain about the file and you know it is a .pcap file then use this command :-</p><p></p><p>┌─[user@parrot]─[~]</p><p>└──╼ $sudo find / -type f -iname *.pcap</p><p>/home/user/nmap_syn_scan.pcap</p><p></p><p></p><p>Move the file into the root directory or run the tcpdump command as root user .</p><p></p><p>Now we can Analyse the packets using wireshark. Run wireshark as superuser ;-</p><p></p><p><img src="images/9-1.png" alt="images/9-1.png" /></p><p></p><p><img src="images/9-2.png" alt="images/9-2.png" /></p><p></p><p>Select the pcap file and start to analyse.</p><p></p><p>Look into capture file properties -</p><p></p><p> <img src="images/9-3.png" alt="images/9-3.png" /></p><p> </p><p> This will show almost every details about the packets and its properties.</p><p> Here this 45 packets are related to both syn and ack packets of tcp - which indicates open ports.</p><p> </p><p> To get a specific source ip packets:-</p><p> </p><p> <img src="images/9-4.png" alt="images/9-4.png" /></p><p> </p><p> To get specific destination ip related packets:-</p><p> </p><p> <img src="images/9-5.png" alt="images/9-5.png" /></p><p> </p><p> </p><p> </p><p> This image shows how to make a filter with one right click . if we want any filter corresponding a specific item , right click on that item and do as shown in image . </p><p> </p><p> To get only  tcp syn packets :-</p><p> </p><p> <img src="images/9-6.png" alt="images/9-6.png" /></p><p> </p><p> Here there are 8269 tcp syn packets out of 12963</p><p> </p><p></p><p>Convert ip address into domain name using name resolution technique :-</p><p></p><p><img src="images/9-7.png" alt="images/9-7.png" /></p><p> </p><p> <img src="images/9-8.png" alt="images/9-8.png" /></p><p> </p><p> </p><p> Look into Protocol Hierarchy Status . where you can find and analyse the whole traffic flow.</p><p> </p><p> <img src="images/9-9.png" alt="images/9-9.png" /></p><p> </p><p> Look into the ARP column - there are 547 ARP packets we captured. this means an ARP request and respond happened in hte network - clearly indicating a Network Scanning in bulk for all 255 hosts. </p><p> </p><p> </p><p> To find open ports of an specific ip address :- </p><p> </p><p> <img src="images/9-10.png" alt="images/9-10.png" /></p><p> </p><p> </p><p> </p><p> </p><p> We can find numerous informations using wireshark , and these are the main way of packet analysis. </p></div>
</body>
</html>
